<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Set up a node - IOTA GoShimmer</title>
                

        <!-- Custom HTML head -->
        

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

                <link rel="icon" href="../favicon.svg">
                        <link rel="shortcut icon" href="../favicon.png">
                <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
                <link rel="stylesheet" href="../css/print.css" media="print">
        
        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
                <link rel="stylesheet" href="../fonts/fonts.css">
        
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        
            </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../goshimmer.html"><strong aria-hidden="true">1.</strong> GoShimmer</a></li><li class="chapter-item expanded "><a href="../faq.html"><strong aria-hidden="true">2.</strong> FAQ</a></li><li class="chapter-item expanded "><a href="../tutorials.html"><strong aria-hidden="true">3.</strong> Tutorials</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../tutorials/setup.html" class="active"><strong aria-hidden="true">3.1.</strong> Set up a node</a></li><li class="chapter-item expanded "><a href="../tutorials/request_funds.html"><strong aria-hidden="true">3.2.</strong> Obtain tokens</a></li><li class="chapter-item expanded "><a href="../tutorials/wallet.html"><strong aria-hidden="true">3.3.</strong> Wallet library</a></li><li class="chapter-item expanded "><a href="../tutorials/dApp.html"><strong aria-hidden="true">3.4.</strong> Write a dApp</a></li><li class="chapter-item expanded "><a href="../tutorials/manual_peering.html"><strong aria-hidden="true">3.5.</strong> Manual peering</a></li><li class="chapter-item expanded "><a href="../tutorials/static_identity.html"><strong aria-hidden="true">3.6.</strong> Create a static identity</a></li><li class="chapter-item expanded "><a href="../tutorials/custom_dRNG.html"><strong aria-hidden="true">3.7.</strong> Set up a custom dRNG committee</a></li><li class="chapter-item expanded "><a href="../tutorials/monitoring.html"><strong aria-hidden="true">3.8.</strong> Set up the Monitoring Dashboard</a></li><li class="chapter-item expanded "><a href="../tutorials/send_transaction.html"><strong aria-hidden="true">3.9.</strong> How to create and send transactions</a></li></ol></li><li class="chapter-item expanded "><a href="../implementation_design.html"><strong aria-hidden="true">4.</strong> Implementation design</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../implementation_design/event_driven_model.html"><strong aria-hidden="true">4.1.</strong> Event driven model</a></li><li class="chapter-item expanded "><a href="../implementation_design/packages_plugins.html"><strong aria-hidden="true">4.2.</strong> Packages and plugins</a></li><li class="chapter-item expanded "><a href="../implementation_design/plugin.html"><strong aria-hidden="true">4.3.</strong> Plugin</a></li><li class="chapter-item expanded "><a href="../implementation_design/configuration_parameters.html"><strong aria-hidden="true">4.4.</strong> Configuration parameters</a></li><li class="chapter-item expanded "><a href="../implementation_design/object_storage.html"><strong aria-hidden="true">4.5.</strong> Object storage</a></li></ol></li><li class="chapter-item expanded "><a href="../protocol_specification.html"><strong aria-hidden="true">5.</strong> Protocol specification</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../protocol_specification/protocol.html"><strong aria-hidden="true">5.1.</strong> Protocol high level overview</a></li><li class="chapter-item expanded "><a href="../protocol_specification/components.html"><strong aria-hidden="true">5.2.</strong> Components</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../protocol_specification/tangle.html"><strong aria-hidden="true">5.2.1.</strong> Tangle</a></li><li class="chapter-item expanded "><a href="../protocol_specification/autopeering.html"><strong aria-hidden="true">5.2.2.</strong> Autopeering</a></li><li class="chapter-item expanded "><a href="../protocol_specification/mana.html"><strong aria-hidden="true">5.2.3.</strong> Mana</a></li><li class="chapter-item expanded "><a href="../protocol_specification/congestion_control.html"><strong aria-hidden="true">5.2.4.</strong> Congestion Control</a></li><li class="chapter-item expanded "><a href="../protocol_specification/consensus_mechanism.html"><strong aria-hidden="true">5.2.5.</strong> Consensus mechanism</a></li><li class="chapter-item expanded "><a href="../protocol_specification/ledgerstate.html"><strong aria-hidden="true">5.2.6.</strong> UTXO and Ledgerstate</a></li><li class="chapter-item expanded "><a href="../protocol_specification/advanced_outputs.html"><strong aria-hidden="true">5.2.7.</strong> Advanced Outputs (Experimental)</a></li><li class="chapter-item expanded "><a href="../protocol_specification/markers.html"><strong aria-hidden="true">5.2.8.</strong> Markers</a></li></ol></li><li class="chapter-item expanded "><a href="../protocol_specification/glossary.html"><strong aria-hidden="true">5.3.</strong> Glossary</a></li></ol></li><li class="chapter-item expanded "><a href="../api.html"><strong aria-hidden="true">6.</strong> API</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../apis/api.html"><strong aria-hidden="true">6.1.</strong> Client Lib</a></li><li class="chapter-item expanded "><a href="../apis/webAPI.html"><strong aria-hidden="true">6.2.</strong> WebAPI</a></li><li class="chapter-item expanded "><a href="../apis/info.html"><strong aria-hidden="true">6.3.</strong> Node info</a></li><li class="chapter-item expanded "><a href="../apis/autopeering.html"><strong aria-hidden="true">6.4.</strong> Autopeering</a></li><li class="chapter-item expanded "><a href="../apis/manual_peering.html"><strong aria-hidden="true">6.5.</strong> Manual peering</a></li><li class="chapter-item expanded "><a href="../apis/communication.html"><strong aria-hidden="true">6.6.</strong> Communication layer</a></li><li class="chapter-item expanded "><a href="../apis/ledgerstate.html"><strong aria-hidden="true">6.7.</strong> Ledgerstate</a></li><li class="chapter-item expanded "><a href="../apis/mana.html"><strong aria-hidden="true">6.8.</strong> Mana</a></li><li class="chapter-item expanded "><a href="../apis/dRNG.html"><strong aria-hidden="true">6.9.</strong> dRNG</a></li><li class="chapter-item expanded "><a href="../apis/snapshot.html"><strong aria-hidden="true">6.10.</strong> Snapshot</a></li><li class="chapter-item expanded "><a href="../apis/faucet.html"><strong aria-hidden="true">6.11.</strong> Faucet</a></li><li class="chapter-item expanded "><a href="../apis/spammer.html"><strong aria-hidden="true">6.12.</strong> Spammer</a></li><li class="chapter-item expanded "><a href="../apis/tools.html"><strong aria-hidden="true">6.13.</strong> Tools</a></li></ol></li><li class="chapter-item expanded "><a href="../tooling.html"><strong aria-hidden="true">7.</strong> Tooling</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../tooling/docker_private_network.html"><strong aria-hidden="true">7.1.</strong> Docker private network</a></li><li class="chapter-item expanded "><a href="../tooling/integration_tests.html"><strong aria-hidden="true">7.2.</strong> Integration tests</a></li></ol></li><li class="chapter-item expanded "><a href="../team_resources.html"><strong aria-hidden="true">8.</strong> Team Resources</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../teamresources/release.html"><strong aria-hidden="true">8.1.</strong> How to do a release</a></li><li class="chapter-item expanded "><a href="../teamresources/guidelines.html"><strong aria-hidden="true">8.2.</strong> Code Guidelines</a></li><li class="chapter-item expanded "><a href="../teamresources/local_development.html"><strong aria-hidden="true">8.3.</strong> Local development</a></li><li class="chapter-item expanded "><a href="../teamresources/analysis_dashboard.html"><strong aria-hidden="true">8.4.</strong> Modify the Analysis dashboard</a></li></ol></li></ol>            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                                                <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                                            </div>

                    <h1 class="menu-title">IOTA GoShimmer</h1>

                    <div class="right-buttons">
                                                <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                                                                        <a href="https://github.com/iotaledger/goshimmer" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                                                
                    </div>
                </div>

                                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="setting-up-a-goshimmer-node"><a class="header" href="#setting-up-a-goshimmer-node">Setting up a GoShimmer node</a></h1>
<p>This page describes how to setup your own GoShimmer node in the GoShimmer testnet with Docker.</p>
<blockquote>
<p>DISCLAIMER: <strong>Note that there will be breaking changes frequently (approx. bi-weekly) where the entire network needs to upgrade. If you don't have time to continuously monitor and upgrade your node, then running a GoShimmer node might not be for you.</strong>  We want to emphasize that running a GoShimmer node requires proper knowledge in Linux and IT related topics such as networking and so on. It is not meant as a node to be run by people with little experience in the mentioned fields. <strong>Do not plan to run any production level services on your node/network.</strong></p>
</blockquote>
<table><thead><tr><th align="left">Contents</th></tr></thead><tbody>
<tr><td align="left"><a href="#why-you-should-run-a-node">Why you should run a node</a></td></tr>
<tr><td align="left"><a href="#installing-goshimmer-with-docker">Installing GoShimmer with Docker</a></td></tr>
<tr><td align="left"><a href="#running-the-goshimmer-node">Running the GoShimmer node</a></td></tr>
<tr><td align="left"><a href="#managing-the-goshimmer-node-lifecycle">Managing the GoShimmer node lifecycle</a></td></tr>
<tr><td align="left"><a href="#setting-up-the-grafana-dashboard">Setting up the Grafana dashboard</a></td></tr>
</tbody></table>
<h2 id="why-you-should-run-a-node"><a class="header" href="#why-you-should-run-a-node">Why you should run a node</a></h2>
<p>Running a node in the GoShimmer testnet helps us in the following ways:</p>
<ul>
<li>It increases the amount of nodes in the network and thus lets it form a more realistic network.</li>
<li>Your node will be configured to send debug log messages to a centralized logger from which we can assess and debug research questions and occurring problems.</li>
<li>Your node is configured to send metric data to a centralized analysis server where we store information such as resource consumption, traffic, FPC vote context processing and so on. This data helps us further fostering the development of GoShimmer and assessing network behavior.</li>
<li>If you expose your HTTP API port, you provide an entrypoint for other people to interact with the network.</li>
</ul>
<blockquote>
<p>Note that any metric data is anonymous.</p>
</blockquote>
<h2 id="installing-goshimmer-with-docker"><a class="header" href="#installing-goshimmer-with-docker">Installing GoShimmer with Docker</a></h2>
<h4 id="hardware-requirements"><a class="header" href="#hardware-requirements">Hardware Requirements</a></h4>
<blockquote>
<p>Note that we do not provide a Docker image or binaries for ARM based systems such as Raspberry Pis.</p>
</blockquote>
<p>We recommend running GoShimmer on a x86 VPS with following minimum hardware specs:</p>
<ul>
<li>2 cores / 4 threads</li>
<li>4 GB of memory</li>
<li>40 GB of disk space</li>
</ul>
<p>A cheap <a href="https://www.hetzner.de/cloud">CX21 Hetzner instance</a> is thereby sufficient.</p>
<p>If you plan on running your GoShimmer node from home, please only do so if you know how to properly configure NAT on your router, as otherwise your node will not correctly participate in the network.</p>
<hr />
<blockquote>
<p>In the following sections we are going to use a CX21 Hetzner instance with Ubuntu 20.04 while being logged in as root</p>
</blockquote>
<p>Lets first upgrade the packages on our system:</p>
<pre><code>apt update &amp;&amp; apt dist-upgrade -y
</code></pre>
<h4 id="install-docker"><a class="header" href="#install-docker">Install Docker</a></h4>
<p>Install needed dependencies:</p>
<pre><code>apt-get install \
     apt-transport-https \
     ca-certificates \
     curl \
     gnupg-agent \
     software-properties-common
</code></pre>
<p>Add Docker’s official GPG key:</p>
<pre><code>curl -fsSL https://download.docker.com/linux/ubuntu/gpg | apt-key add -
</code></pre>
<p>Verify that the GPG key matches:</p>
<pre><code>apt-key fingerprint 0EBFCD88
pub   rsa4096 2017-02-22 [SCEA]
      9DC8 5822 9FC7 DD38 854A  E2D8 8D81 803C 0EBF CD88
uid           [ unknown] Docker Release (CE deb) &lt;docker@docker.com&gt;
sub   rsa4096 2017-02-22 [S]

</code></pre>
<p>Add the actual repository:</p>
<pre><code>add-apt-repository \
   &quot;deb [arch=amd64] https://download.docker.com/linux/ubuntu \
   $(lsb_release -cs) \
   stable&quot;
</code></pre>
<p>Update the package index:</p>
<pre><code>apt-get update
</code></pre>
<p>And finally, install docker:</p>
<pre><code>apt-get install docker-ce docker-ce-cli containerd.io
</code></pre>
<p>On windows-subsystem for Linux (WSL2) it may be necessary to start docker seperately:</p>
<pre><code>/etc/init.d/docker start
</code></pre>
<p>Note, this may not work on WSL1.</p>
<p>Check whether docker is running by executing <code>docker ps</code>:</p>
<pre><code>docker ps
CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS               NAMES
</code></pre>
<h3 id="install-docker-compose"><a class="header" href="#install-docker-compose">Install Docker Compose</a></h3>
<p>Docker compose gives us the ability to define our services with <code>docker-compose.yml</code> files instead of having to define all container parameters directly on the CLI.</p>
<p>Download docker compose:</p>
<pre><code>curl -L &quot;https://github.com/docker/compose/releases/download/1.26.0/docker-compose-$(uname -s)-$(uname -m)&quot; -o /usr/local/bin/docker-compose
</code></pre>
<p>Make it executable:</p>
<pre><code>chmod +x /usr/local/bin/docker-compose
</code></pre>
<p>Check that docker compose works:</p>
<pre><code>docker-compose --version
docker-compose version 1.26.0, build d4451659
</code></pre>
<h3 id="define-the-docker-composeyml"><a class="header" href="#define-the-docker-composeyml">Define the docker-compose.yml</a></h3>
<p>First, lets create a user defined bridged network. Unlike the already existing <code>bridge</code> network, the user defined one will have container name DNS resolution for containers within that network. This is useful if later we want to setup additional containers which need to speak with the GoShimmer container.</p>
<pre><code>docker network create --driver=bridge shimmer
c726034d295c3df66803b92c71ca517a0cf0e3c65c1c6d84ee5fa34ae76cbcd4
</code></pre>
<p>Lets create a folder holding our <code>docker-compose.yml</code>:</p>
<pre><code>mkdir /opt/goshimmer
</code></pre>
<p>Lets create a folder holding our database:</p>
<pre><code>cd /opt/goshimmer
mkdir db
chmod 0777 db
</code></pre>
<p>Finally, lets create our <code>docker-compose.yml</code>:</p>
<pre><code>nano docker-compose.yml
</code></pre>
<p>and add following content:</p>
<pre><code class="language-yaml">version: '3.3'

networks:
  outside:
    external:
      name: shimmer

services:
  goshimmer:
    image: iotaledger/goshimmer:latest
    container_name: goshimmer
    hostname: goshimmer
    stop_grace_period: 2m
    volumes:
      - &quot;./db:/tmp/mainnetdb:rw&quot;   
      - &quot;/etc/localtime:/etc/localtime:ro&quot;
    ports:
      # Autopeering 
      - &quot;0.0.0.0:14626:14626/udp&quot;
      # Gossip
      - &quot;0.0.0.0:14666:14666/tcp&quot;
      # FPC
      - &quot;0.0.0.0:10895:10895/tcp&quot;
      # HTTP API
      - &quot;0.0.0.0:8080:8080/tcp&quot;
      # Dashboard
      - &quot;0.0.0.0:8081:8081/tcp&quot;
      # pprof profiling
      - &quot;0.0.0.0:6061:6061/tcp&quot;
    environment:
      - ANALYSIS_CLIENT_SERVERADDRESS=ressims.iota.cafe:21888
      - AUTOPEERING_PORT=14626
      - DASHBOARD_BINDADDRESS=0.0.0.0:8081
      - GOSSIP_PORT=14666
      - WEBAPI_BINDADDRESS=0.0.0.0:8080
      - PROFILING_BINDADDRESS=0.0.0.0:6061
      - NETWORKDELAY_ORIGINPUBLICKEY=9DB3j9cWYSuEEtkvanrzqkzCQMdH1FGv3TawJdVbDxkd
      - FPC_BINDADDRESS=0.0.0.0:10895
      - PROMETHEUS_BINDADDRESS=0.0.0.0:9311
    command: &gt;
      --skip-config=true
      --autopeering.entryNodes=2PV5487xMw5rasGBXXWeqSi4hLz7r19YBt8Y1TGAsQbj@ressims.iota.cafe:15626,5EDH4uY78EA6wrBkHHAVBWBMDt7EcksRq6pjzipoW15B@entryshimmer.tanglebay.com:14646
      --node.disablePlugins=
      --node.enablePlugins=remotelog,networkdelay,spammer,prometheus
      --logger.level=info
      --logger.disableEvents=false
      --logger.remotelog.serverAddress=ressims.iota.cafe:5213
      --drng.pollen.instanceId=1
      --drng.pollen.threshold=3
      --drng.pollen.committeeMembers=AheLpbhRs1XZsRF8t8VBwuyQh9mqPHXQvthV5rsHytDG,FZ28bSTidszUBn8TTCAT9X1nVMwFNnoYBmZ1xfafez2z,GT3UxryW4rA9RN9ojnMGmZgE2wP7psagQxgVdA4B9L1P,4pB5boPvvk2o5MbMySDhqsmC2CtUdXyotPPEpb7YQPD7,64wCsTZpmKjRVHtBKXiFojw7uw3GszumfvC4kHdWsHga
      --drng.xteam.instanceId=1339
      --drng.xteam.threshold=4
      --drng.xteam.committeeMembers=GUdTwLDb6t6vZ7X5XzEnjFNDEVPteU7tVQ9nzKLfPjdo,68vNzBFE9HpmWLb2x4599AUUQNuimuhwn3XahTZZYUHt,Dc9n3JxYecaX3gpxVnWb4jS3KVz1K1SgSK1KpV1dzqT1,75g6r4tqGZhrgpDYZyZxVje1Qo54ezFYkCw94ELTLhPs,CN1XLXLHT9hv7fy3qNhpgNMD6uoHFkHtaNNKyNVCKybf,7SmttyqrKMkLo5NPYaiFoHs8LE6s7oCoWCQaZhui8m16,CypSmrHpTe3WQmCw54KP91F5gTmrQEL7EmTX38YStFXx
    networks:
      - outside
</code></pre>
<blockquote>
<p>If performance is a concern, you can also run your containers with <code>network_mode: &quot;host&quot;</code>, however, you must then adjust the hostnames in the configs for the corresponding containers and perhaps also create some iptable rules to block traffic from outside accessing your services directly.</p>
</blockquote>
<p>Note how we are setting up NATs for different ports:</p>
<table><thead><tr><th>Port</th><th>Functionality</th><th>Protocol</th></tr></thead><tbody>
<tr><td>14626</td><td>Autopeering</td><td>UDP</td></tr>
<tr><td>14666</td><td>Gossip</td><td>TCP</td></tr>
<tr><td>10895</td><td>FPC</td><td>TCP/HTTP</td></tr>
<tr><td>8080</td><td>HTTP API</td><td>TCP/HTTP</td></tr>
<tr><td>8081</td><td>Dashboard</td><td>TCP/HTTP</td></tr>
<tr><td>6061</td><td>pprof HTTP API</td><td>TCP/HTTP</td></tr>
</tbody></table>
<p>It is important that the ports are correctly mapped so that the node for example actively participates in FPC votes or can gain inbound neighbors.</p>
<blockquote>
<p>If the UDP NAT mapping is not configured correctly, GoShimmer will terminate with an error message stating to check the NAT configuration</p>
</blockquote>
<h2 id="running-the-goshimmer-node"><a class="header" href="#running-the-goshimmer-node">Running the GoShimmer node</a></h2>
<p>Within the <code>/opt/goshimmer</code> folder where the <code>docker-compose.yml</code> resides, simply execute:</p>
<pre><code>docker-compose up -d
Pulling goshimmer (iotaledger/goshimmer:0.2.0)...
...
</code></pre>
<p>to start the GoShimmer node.</p>
<p>You should see your container running now:</p>
<pre><code>CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                                                                                                                                    NAMES
687f52b78cb5        iotaledger/goshimmer:0.2.0       &quot;/run/goshimmer --sk…&quot;   19 seconds ago      Up 17 seconds       0.0.0.0:6061-&gt;6061/tcp, 0.0.0.0:8080-8081-&gt;8080-8081/tcp, 0.0.0.0:10895-&gt;10895/tcp, 0.0.0.0:14666-&gt;14666/tcp, 0.0.0.0:14626-&gt;14626/udp   goshimmer
</code></pre>
<p>You can follow the log output of the node via:</p>
<pre><code>docker logs -f --since=1m goshimmer
</code></pre>
<h3 id="syncing"><a class="header" href="#syncing">Syncing</a></h3>
<p>When the node starts for the first time, it must synchronize its state with the rest of the network. GoShimmer currently uses the Tangle Time to help nodes determine their synced status.</p>
<h4 id="dashboard"><a class="header" href="#dashboard">Dashboard</a></h4>
<p>The dashboard of your GoShimmer node should be accessible via <code>http://&lt;your-ip&gt;:8081</code>. If your node is still synchronizing, you might see a higher inflow of MPS.</p>
<p><img src="https://user-images.githubusercontent.com/11289354/119599542-c3985e00-be17-11eb-8769-7e639f365ae5.png" alt="" /></p>
<p>After a while, your node's dashboard should also display up to 8 neighbors:
<img src="https://i.imgur.com/gAyAXK9.png" alt="" /></p>
<h4 id="http-api"><a class="header" href="#http-api">HTTP API</a></h4>
<p>GoShimmer also exposes an HTTP API. To check whether that works correctly, you can access it via <code>http://&lt;your-ip&gt;:8080/info</code> which should return a JSON response in the form of:</p>
<pre><code>{
  &quot;version&quot;: &quot;v0.6.2&quot;,
  &quot;networkVersion&quot;: 30,
  &quot;tangleTime&quot;: {
    &quot;messageID&quot;: &quot;6ndfmfogpH9H8C9X9Fbb7Jmuf8RJHQgSjsHNPdKUUhoJ&quot;,
    &quot;time&quot;: 1621879864032595415,
    &quot;synced&quot;: true
  },
  &quot;identityID&quot;: &quot;D9SPFofAGhA5V9QRDngc1E8qG9bTrnATmpZMdoyRiBoW&quot;,
  &quot;identityIDShort&quot;: &quot;XBgY5DsUPng&quot;,
  &quot;publicKey&quot;: &quot;9DB3j9cWYSuEEtkvanrzqkzCQMdH1FGv3TawJdVbDxkd&quot;,
  &quot;solidMessageCount&quot;: 74088,
  &quot;totalMessageCount&quot;: 74088,
  &quot;enabledPlugins&quot;: [
    ...
  ],
  &quot;disabledPlugins&quot;: [
    ...
  ],
  &quot;mana&quot;: {
    &quot;access&quot;: 1,
    &quot;accessTimestamp&quot;: &quot;2021-05-24T20:11:05.451224937+02:00&quot;,
    &quot;consensus&quot;: 10439991680906,
    &quot;consensusTimestamp&quot;: &quot;2021-05-24T20:11:05.451228137+02:00&quot;
  },
  &quot;manaDelegationAddress&quot;: &quot;1HMQic52dz3xLY2aeDXcDhX53LgbsHghdfD8eGXR1qVHy&quot;,
  &quot;mana_decay&quot;: 0.00003209,
  &quot;scheduler&quot;: {
    &quot;running&quot;: true,
    &quot;rate&quot;: &quot;5ms&quot;,
    &quot;nodeQueueSizes&quot;: {}
  },
  &quot;rateSetter&quot;: {
    &quot;rate&quot;: 20000,
    &quot;size&quot;: 0
  }
}
</code></pre>
<h2 id="managing-the-goshimmer-node-lifecycle"><a class="header" href="#managing-the-goshimmer-node-lifecycle">Managing the GoShimmer node lifecycle</a></h2>
<h5 id="stopping-the-node"><a class="header" href="#stopping-the-node">Stopping the node</a></h5>
<pre><code>docker-compose stop
</code></pre>
<h5 id="resetting-the-node"><a class="header" href="#resetting-the-node">Resetting the node</a></h5>
<pre><code>docker-compose down
</code></pre>
<h5 id="upgrading-the-node"><a class="header" href="#upgrading-the-node">Upgrading the node</a></h5>
<p><strong>Ensure that the image version in the <code>docker-compose.yml</code> is <code>latest</code></strong> then execute following commands:</p>
<pre><code>docker-compose down
rm db/*
docker-compose pull
docker-compose up -d
</code></pre>
<h5 id="following-log-output"><a class="header" href="#following-log-output">Following log output</a></h5>
<pre><code>docker logs -f --since=1m goshimmer
</code></pre>
<h5 id="create-a-logtxt"><a class="header" href="#create-a-logtxt">Create a log.txt</a></h5>
<pre><code>docker logs goshimmer &gt; log.txt
</code></pre>
<h5 id="update-grafana-dashboard"><a class="header" href="#update-grafana-dashboard">Update Grafana Dashboard</a></h5>
<p>If you set up the Grafana dashboard for your node according to the next section &quot;Setting up the Grafana dashboard&quot;, the following method will help you to update when a new version is released.</p>
<p>You have to manually copy the new <a href="https://github.com/iotaledger/goshimmer/blob/master/tools/monitoring/grafana/dashboards/local_dashboard.json">dashboard file</a> into <code>/opt/goshimmer/grafana/dashboards</code> directory.
Supposing you are at <code>/opt/goshimmer/</code>:</p>
<pre><code>wget https://raw.githubusercontent.com/iotaledger/goshimmer/master/tools/monitoring/grafana/dashboards/local_dashboard.json
cp local_dashboard.json grafana/dashboards
</code></pre>
<p>Restart the grafana container:</p>
<pre><code>docker restart grafana
</code></pre>
<h2 id="setting-up-the-grafana-dashboard"><a class="header" href="#setting-up-the-grafana-dashboard">Setting up the Grafana dashboard</a></h2>
<h4 id="add-prometheus-and-grafana-containers-to-docker-composeyml"><a class="header" href="#add-prometheus-and-grafana-containers-to-docker-composeyml">Add Prometheus and Grafana Containers to <code>docker-compose.yml</code></a></h4>
<p>Append the following to the previously described <code>docker-compose.yml</code> file (<strong>make sure to also copy the space in front of &quot;prometheus&quot;/the entire whitespace</strong>):</p>
<pre><code class="language-yaml">  prometheus:
    image: prom/prometheus:latest
    container_name: prometheus
    restart: unless-stopped
    ports:
      - &quot;9090:9090/tcp&quot;
    command:
      - --config.file=/etc/prometheus/prometheus.yml
    volumes:
      - ./prometheus/prometheus.yml:/etc/prometheus/prometheus.yml:ro
      - ./prometheus/data:/prometheus:rw
    depends_on:
      - goshimmer
    networks:
      - outside

  grafana:
    image: grafana/grafana:latest
    container_name: grafana
    restart: unless-stopped
    environment:
      # path to provisioning definitions can only be defined as
      # environment variables for grafana within docker
      - GF_PATHS_PROVISIONING=/var/lib/grafana/provisioning
    ports:
      - &quot;3000:3000/tcp&quot;
    user: &quot;472&quot;
    volumes:
      - ./grafana:/var/lib/grafana:rw
    networks:
      - outside
</code></pre>
<h4 id="create-prometheus-config"><a class="header" href="#create-prometheus-config">Create Prometheus config</a></h4>
<ol>
<li>Create a <code>prometheus/data</code> directory in <code>/opt/goshimmer</code>:</li>
</ol>
<pre><code>cd /opt/goshimmer
mkdir -p prometheus/data
</code></pre>
<ol start="2">
<li>Create a <code>prometheus.yml</code> in <code>prometheus</code> directory:</li>
</ol>
<pre><code>nano prometheus/prometheus.yml
</code></pre>
<p>The content of the file should be:</p>
<pre><code class="language-yaml">scrape_configs:
    - job_name: goshimmer_local
      scrape_interval: 5s
      static_configs:
      - targets:
        - goshimmer:9311
</code></pre>
<ol start="3">
<li>Add permissions to <code>prometheus</code> config directory:</li>
</ol>
<pre><code>chmod -R 777 prometheus
</code></pre>
<h4 id="create-grafana-configs"><a class="header" href="#create-grafana-configs">Create Grafana configs</a></h4>
<ol>
<li>Create necessary config dirs in <code>/opt/goshimmer/</code>.</li>
</ol>
<pre><code>mkdir -p grafana/provisioning/datasources grafana/provisioning/dashboards grafana/provisioning/notifiers
mkdir -p grafana/dashboards
</code></pre>
<ol start="2">
<li>Create a datasource configuration file in <code>grafana/provisioning/datasources</code>:</li>
</ol>
<pre><code>nano grafana/provisioning/datasources/datasources.yaml
</code></pre>
<p>With the following content:</p>
<pre><code class="language-yaml">apiVersion: 1

datasources:
  - name: Prometheus
    type: prometheus
    # &lt;string, required&gt; access mode. proxy or direct (Server or Browser in the UI). Required
    access: proxy
    orgId: 1
    url: http://prometheus:9090
    jsonData:
      graphiteVersion: '1.1'
      timeInterval: '1s'
    # &lt;string&gt; json object of data that will be encrypted.
    secureJsonData:
      # &lt;string&gt; database password, if used
      password:
      # &lt;string&gt; basic auth password
      basicAuthPassword:
    version: 1
    # &lt;bool&gt; allow users to edit datasources from the UI.
    editable: true
</code></pre>
<ol start="3">
<li>Create a dashboard configuration file in <code>grafana/provisioning/dashboards</code>:</li>
</ol>
<pre><code>nano grafana/provisioning/dashboards/dashboards.yaml
</code></pre>
<p>With the following content:</p>
<pre><code class="language-yaml">apiVersion: 1

providers:
  - name: 'Goshimmer Local Metrics'
    orgId: 1
    folder: ''
    type: file
    disableDeletion: false
    editable: true
    updateIntervalSeconds: 10
    allowUiUpdates: true
    options:
      path: /var/lib/grafana/dashboards
</code></pre>
<ol start="4">
<li>Add predefined GoShimmer Local Metrics Dashboard.</li>
</ol>
<p>Head over to the GoShimmer repository and download <a href="https://github.com/iotaledger/goshimmer/blob/master/tools/monitoring/grafana/dashboards/local_dashboard.json">local_dashboard.json</a>.</p>
<pre><code>wget https://raw.githubusercontent.com/iotaledger/goshimmer/master/tools/monitoring/grafana/dashboards/local_dashboard.json
cp local_dashboard.json grafana/dashboards
</code></pre>
<ol start="5">
<li>Add permissions to Grafana config folder</li>
</ol>
<pre><code>chmod -R 777 grafana
</code></pre>
<h4 id="run-goshimmer-with-prometheus-and-grafana"><a class="header" href="#run-goshimmer-with-prometheus-and-grafana">Run GoShimmer with Prometheus and Grafana:</a></h4>
<pre><code>docker-compose up -d
</code></pre>
<p>The Grafana dashboard should be accessible at <code>http://&lt;your-ip&gt;:3000</code>.</p>
<p>Default login credentials are:</p>
<ul>
<li><code>username</code>: admin</li>
<li><code>password</code>: admin</li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                                                    <a rel="prev" href="../tutorials.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        
                                                    <a rel="next" href="../tutorials/request_funds.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                                    <a rel="prev" href="../tutorials.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                
                                    <a rel="next" href="../tutorials/request_funds.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                            </nav>

        </div>

        
        
        
                <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        
        
                <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>
        
        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        
        
    </body>
</html>
